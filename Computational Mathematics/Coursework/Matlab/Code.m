clc;
format longG
X = 0:0.0002:0.004;
Y2 = [0 0 0.4 1.1992 2.3808 3.9120 5.7450 7.8178 10.0567 12.3784 14.6931 16.9082 18.9310 20.6735 22.0552 23.0073 23.4752 23.4219 22.8297 21.7018 20.0630; 0 2000 3996 5908.008 7656.351984 9164.878960032 10364.1348027519 11194.3969753852 11608.433231563 11573.8655362131 11075.0296469914 10114.2368080996 8712.36436900597 6908.7262024665 4760.20073749988 2339.62327536452 -266.521061346552 -2961.03804039879 -5639.50514303906 -8194.17378985809 -10518.1528936619];
Y1 = [0 2000 3996 5908.008 7656.351984 9164.878960032 10364.1348027519 11194.3969753852 11608.433231563 11573.8655362131 11075.0296469914 10114.2368080996 8712.36436900597 6908.7262024665 4760.20073749988 2339.62327536452 -266.521061346552 -2961.03804039879 -5639.50514303906 -8194.17378985809 -10518.1528936619];
disp([X',Y2'])

[m5]=polyfit(X',Y1',5);
disp('M5')
disp(m5');
[m3]=polyfit(X',Y1',3);
disp('M3')
disp(m3');

x=0:0.00001:0.004;
y5=@(x)(m5(1).*x.^5+m5(2).*x.^4+m5(3).*x.^3+m5(4).*x.^2+m5(5).*x+m5(6));
y3=@(x)(m3(1).*x.^3+m3(2).*x.^2+m3(3).*x+m3(4));
plot(X,Y1,'b-o',x,y5(x),'r-.',x,y3(x),'-g');
grid;
legend('ODU','m5','m3');

a5=polyfit(X,Y1,5);
y5=polyval(a5,X);
e5=sum((Y1-y5).^2)/length(Y1);
a3=polyfit(X,Y1,3);
y3=polyval(a3,X);
e3=sum((Y1-y3).^2)/length(Y1);

y5=@(x)-(m5(1).*x.^5+m5(2).*x.^4+m5(3).*x.^3+m5(4).*x.^2+m5(5).*x+m5(6));
[x,y]=fminbnd(y5,0,0.004);
disp('X')
disp(x)
disp('-Y')
disp(-y)